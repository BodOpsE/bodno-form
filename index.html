<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bodno.com ‚Äî Customer Onboarding Specialist Application</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700&family=Plus+Jakarta+Sans:wght@600;700;800&display=swap" rel="stylesheet">
<style>
:root{--navy:#0B1D3A;--blue:#1B5299;--blue-light:#2A7FDB;--accent:#FF6B35;--accent-hover:#E55A28;--bg:#F4F6F9;--card:#FFFFFF;--text:#1A2332;--text-muted:#5A6B7F;--border:#D8DFE8;--border-focus:#2A7FDB;--error:#DC3545;--success-bg:#E8F5E9;--success:#2E7D32;--warning-bg:#FFF3E0;--warning-border:#FF9800;--warning-text:#E65100;--radius:10px;--shadow:0 2px 12px rgba(11,29,58,0.06);--shadow-lg:0 8px 32px rgba(11,29,58,0.10)}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',-apple-system,sans-serif;background:var(--bg);color:var(--text);line-height:1.6;-webkit-font-smoothing:antialiased}
.header{background:linear-gradient(135deg,var(--navy) 0%,var(--blue) 100%);padding:44px 24px 52px;text-align:center;position:relative;overflow:hidden}
.header::before{content:'';position:absolute;top:-50%;right:-20%;width:500px;height:500px;background:radial-gradient(circle,rgba(255,107,53,0.12) 0%,transparent 70%);border-radius:50%}
.header-logo{font-family:'Plus Jakarta Sans',sans-serif;font-size:28px;font-weight:800;color:white;letter-spacing:-0.5px;position:relative}
.header-logo span{color:var(--accent)}
.header-title{font-family:'Plus Jakarta Sans',sans-serif;font-size:20px;font-weight:700;color:rgba(255,255,255,0.95);margin-top:10px;position:relative}
.header-sub{color:rgba(255,255,255,0.6);font-size:14px;margin-top:6px;position:relative}
.admin-toggle{position:fixed;bottom:20px;right:20px;z-index:1000;background:var(--navy);color:white;border:none;padding:10px 18px;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;box-shadow:var(--shadow-lg);transition:all 0.2s}
.admin-toggle:hover{background:var(--blue);transform:translateY(-1px)}
.container{max-width:700px;margin:-24px auto 48px;padding:0 16px;position:relative}
.container-wide{max-width:1200px;margin:-24px auto 48px;padding:0 16px;position:relative}
.card{background:var(--card);border-radius:var(--radius);padding:28px 32px;box-shadow:var(--shadow);margin-bottom:16px}
.card-accent{background:var(--warning-bg);border:2px solid var(--warning-border);border-radius:var(--radius);padding:20px 24px;margin-bottom:16px}
.card-accent h3{font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:700;color:var(--warning-text);margin-bottom:6px}
.card-accent p{font-size:13px;color:var(--warning-text);opacity:0.85;line-height:1.6}
.card-accent strong{font-weight:700}
.section-label{font-family:'Plus Jakarta Sans',sans-serif;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--blue);margin-bottom:20px;padding-bottom:12px;border-bottom:2px solid var(--bg)}
.field{margin-bottom:22px}.field:last-child{margin-bottom:0}
.field label{display:block;font-size:14px;font-weight:600;color:var(--text);margin-bottom:5px}
.field label .req{color:var(--error);margin-left:2px}
.field .hint{font-size:12px;color:var(--text-muted);margin-bottom:7px;line-height:1.5}
input[type="text"],input[type="email"],input[type="tel"],input[type="url"],textarea,select{width:100%;padding:11px 14px;border:1.5px solid var(--border);border-radius:8px;font-family:'DM Sans',sans-serif;font-size:14px;color:var(--text);background:#FAFBFC;transition:all 0.2s;outline:none}
input:focus,textarea:focus,select:focus{border-color:var(--border-focus);background:white;box-shadow:0 0 0 3px rgba(42,127,219,0.1)}
textarea{resize:vertical;min-height:110px;line-height:1.6}
.radio-group{display:flex;flex-direction:column;gap:6px}
.radio-option{display:flex;align-items:flex-start;gap:10px;padding:11px 14px;border:1.5px solid var(--border);border-radius:8px;cursor:pointer;transition:all 0.15s;background:#FAFBFC}
.radio-option:hover{border-color:var(--blue-light);background:rgba(42,127,219,0.03)}
.radio-option.selected{border-color:var(--blue);background:rgba(42,127,219,0.06)}
.radio-option input[type="radio"]{margin-top:3px;accent-color:var(--blue)}
.radio-option span{font-size:13.5px;line-height:1.5}
.checkbox-group{display:flex;flex-wrap:wrap;gap:8px}
.checkbox-option{display:flex;align-items:center;gap:8px;padding:9px 14px;border:1.5px solid var(--border);border-radius:8px;cursor:pointer;transition:all 0.15s;background:#FAFBFC;font-size:13px}
.checkbox-option:hover{border-color:var(--blue-light)}
.checkbox-option.selected{border-color:var(--blue);background:rgba(42,127,219,0.06)}
.checkbox-option input[type="checkbox"]{accent-color:var(--blue)}
.btn-primary{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:14px 32px;background:var(--accent);color:white;border:none;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:15px;font-weight:700;cursor:pointer;transition:all 0.2s;width:100%}
.btn-primary:hover{background:var(--accent-hover);transform:translateY(-1px);box-shadow:var(--shadow-lg)}
.btn-primary:disabled{opacity:0.6;cursor:not-allowed;transform:none}
.btn-secondary{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:10px 20px;background:var(--blue);color:white;border:none;border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s}
.btn-secondary:hover{background:var(--navy)}
.btn-outline{display:inline-flex;align-items:center;gap:6px;padding:10px 20px;background:white;color:var(--blue);border:1.5px solid var(--blue);border-radius:8px;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.2s}
.btn-outline:hover{background:rgba(42,127,219,0.05)}
.success-screen{text-align:center;padding:60px 32px}
.success-icon{width:72px;height:72px;background:var(--success-bg);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;font-size:36px}
.success-screen h2{font-family:'Plus Jakarta Sans',sans-serif;font-size:22px;font-weight:700;color:var(--text);margin-bottom:10px}
.success-screen p{font-size:14.5px;color:var(--text-muted);max-width:440px;margin:0 auto}
.spinner{display:inline-block;width:20px;height:20px;border:3px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:spin 0.6s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.admin-bar{display:flex;flex-wrap:wrap;gap:12px;align-items:center;margin-bottom:16px}
.admin-bar .filter-group{display:flex;align-items:center;gap:6px}
.admin-bar select{width:auto;padding:8px 12px;font-size:13px;min-width:150px}
.admin-bar .count{font-size:13px;color:var(--text-muted);font-weight:500}
.admin-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-bottom:20px}
.stat-card{background:var(--card);border-radius:8px;padding:16px 18px;box-shadow:var(--shadow);text-align:center}
.stat-card .stat-num{font-family:'Plus Jakarta Sans',sans-serif;font-size:28px;font-weight:800;color:var(--blue)}
.stat-card .stat-label{font-size:11px;color:var(--text-muted);font-weight:600;text-transform:uppercase;letter-spacing:0.5px;margin-top:2px}
.table-wrap{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:13px}
thead{background:var(--navy)}
thead th{padding:12px 14px;text-align:left;color:white;font-weight:600;font-size:12px;text-transform:uppercase;letter-spacing:0.5px;white-space:nowrap;position:sticky;top:0}
tbody tr{border-bottom:1px solid var(--bg);transition:background 0.1s}
tbody tr:hover{background:rgba(42,127,219,0.03)}
tbody td{padding:10px 14px;vertical-align:top}
td.truncate{max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.badge{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;white-space:nowrap}
.badge-green{background:#E8F5E9;color:#2E7D32}
.badge-yellow{background:#FFF8E1;color:#F57F17}
.badge-red{background:#FFEBEE;color:#C62828}
.expand-btn{background:none;border:1px solid var(--border);border-radius:6px;padding:4px 10px;font-size:11px;cursor:pointer;color:var(--blue);font-family:'DM Sans',sans-serif;font-weight:600}
.expand-btn:hover{background:var(--bg)}
.modal-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(11,29,58,0.5);z-index:2000;align-items:center;justify-content:center}
.modal-overlay.active{display:flex}
.modal{background:white;border-radius:12px;padding:32px;max-width:640px;width:90%;max-height:85vh;overflow-y:auto;box-shadow:var(--shadow-lg)}
.modal h3{font-family:'Plus Jakarta Sans',sans-serif;font-size:18px;font-weight:700;margin-bottom:20px;color:var(--text)}
.modal .detail-row{margin-bottom:14px;padding-bottom:14px;border-bottom:1px solid var(--bg)}
.modal .detail-row:last-child{border:none;margin:0;padding:0}
.modal .detail-label{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:var(--text-muted);margin-bottom:3px}
.modal .detail-value{font-size:14px;color:var(--text);line-height:1.6}
.modal-close{float:right;background:none;border:none;font-size:22px;cursor:pointer;color:var(--text-muted);padding:0 4px}
.modal-close:hover{color:var(--text)}
.password-screen{text-align:center;padding:60px 32px}
.password-screen h2{font-family:'Plus Jakarta Sans',sans-serif;font-size:20px;font-weight:700;margin-bottom:16px}
.password-screen input{max-width:280px;margin:0 auto 12px;display:block;text-align:center}
.password-screen .btn-primary{max-width:280px;margin:0 auto}
.pw-error{color:var(--error);font-size:13px;margin-top:8px;display:none}
.error-banner{background:#FFEBEE;border:1.5px solid #EF9A9A;border-radius:8px;padding:16px 20px;margin-bottom:16px;color:#C62828;font-size:13px;display:none}
@media(max-width:600px){.header{padding:32px 16px 40px}.header-logo{font-size:24px}.header-title{font-size:17px}.card,.card-accent{padding:20px}.admin-bar{flex-direction:column;align-items:stretch}.checkbox-group{flex-direction:column}}
</style>
</head>
<body>

<script>
// ============================================================
// ‚¨áÔ∏è PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL BELOW ‚¨áÔ∏è
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwxsJNyoI7og6JzG7_fIWuAtZEE1Gp2Y9JAMWf312Lq2U2iYi6AaVV52PGiIZbkp79x9A/exec';
// ‚¨ÜÔ∏è PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL ABOVE ‚¨ÜÔ∏è
// ============================================================
</script>

<div class="header" id="mainHeader">
  <div class="header-logo">BODNO<span>.com</span></div>
  <div class="header-title" id="headerTitle">Customer Onboarding Specialist Application</div>
  <div class="header-sub" id="headerSub">Remote ‚Äî Full-time ‚Äî $600/mo base + up to $400/mo commission</div>
</div>

<button class="admin-toggle" onclick="showAdminLogin()" id="adminToggle">üîí Admin</button>

<!-- ===== FORM ===== -->
<div id="formView" class="container">
  <div class="card" id="introCard">
    <p style="font-size:14px;color:var(--text-muted);line-height:1.7">
      Thank you for your interest in joining <strong>Bodno.com</strong>! We are a leading U.S.-based ecommerce company specializing in ID card printers, software, and supplies. We are an <strong>AI-forward company</strong> looking for a long-term team member (5+ years) to deliver an exceptional customer onboarding experience. Please complete every question carefully ‚Äî <strong>incomplete applications will not be reviewed.</strong>
    </p>
  </div>
  <div class="card-accent" id="warningCard">
    <h3>‚ö†Ô∏è Important ‚Äî Schedule &amp; Experience Requirement</h3>
    <p>This role requires working <strong>9:00 AM‚Äì6:00 PM Eastern Standard Time</strong>, which corresponds to evening/nighttime hours in the Philippines. These hours are <strong>not flexible</strong>. You must have a <strong>minimum of 2 years of graveyard/night shift experience</strong> working with U.S. time zones. Candidates without this experience will not be considered.</p>
  </div>
  <div class="error-banner" id="formError"></div>

  <form id="applicationForm" onsubmit="submitForm(event)">
    <div class="card">
      <div class="section-label">Basic Information</div>
      <div class="field"><label>Email Address <span class="req">*</span></label><input type="email" name="email" required placeholder="your@email.com"></div>
      <div class="field"><label>First and Last Name <span class="req">*</span></label><input type="text" name="fullName" required placeholder="Juan Dela Cruz"></div>
      <div class="field"><label>WhatsApp Phone Number <span class="req">*</span></label><input type="tel" name="whatsapp" required placeholder="+63 9XX XXX XXXX"></div>
      <div class="field"><label>Link to your OnlineJobs.ph Profile <span class="req">*</span></label><input type="url" name="ojphProfile" required placeholder="https://www.onlinejobs.ph/jobseekers/info/..."></div>
      <div class="field"><label>Link to your Resume <span class="req">*</span></label><input type="url" name="resumeLink" required placeholder="https://drive.google.com/..."></div>
      <div class="field"><label>Link to your Video Introduction (30 sec ‚Äì 2 min) <span class="req">*</span></label><div class="hint">Record a short video explaining why you'd be a great fit. Highlight your charisma, communication skills, and relevant experience.</div><input type="url" name="videoLink" required placeholder="https://www.loom.com/... or YouTube/Drive link"></div>
    </div>

    <div class="card">
      <div class="section-label">Experience &amp; Qualifications</div>
      <div class="field">
        <label>Are you an enthusiastic, upbeat, and charismatic person? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="enthusiasm" value="Yes ‚Äî I thrive in customer-facing roles and bring energy to every interaction" required><span>Yes ‚Äî I thrive in customer-facing roles and bring energy to every interaction</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="enthusiasm" value="Somewhat ‚Äî I'm professional but more reserved"><span>Somewhat ‚Äî I'm professional but more reserved</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="enthusiasm" value="No"><span>No</span></label>
        </div>
      </div>
      <div class="field">
        <label>Years of experience in customer onboarding, training, or support? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="csExperience" value="Less than 1 year" required><span>Less than 1 year</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="csExperience" value="1‚Äì2 years"><span>1‚Äì2 years</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="csExperience" value="2‚Äì4 years"><span>2‚Äì4 years</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="csExperience" value="5+ years"><span>5+ years</span></label>
        </div>
      </div>
      <div class="field">
        <label>Years of graveyard/night shift experience with U.S. time zones? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="graveyardExperience" value="No graveyard shift experience" required><span>No graveyard shift experience</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="graveyardExperience" value="Less than 1 year"><span>Less than 1 year</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="graveyardExperience" value="1‚Äì2 years"><span>1‚Äì2 years</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="graveyardExperience" value="2+ years"><span>2+ years</span></label>
        </div>
      </div>
      <div class="field">
        <label>Which tools do you have experience with? <span class="req">*</span></label>
        <div class="hint">Select all that apply</div>
        <div class="checkbox-group">
          <label class="checkbox-option" onclick="toggleCheck(this)"><input type="checkbox" name="tools" value="HubSpot"> HubSpot</label>
          <label class="checkbox-option" onclick="toggleCheck(this)"><input type="checkbox" name="tools" value="Shopify"> Shopify</label>
          <label class="checkbox-option" onclick="toggleCheck(this)"><input type="checkbox" name="tools" value="Aircall"> Aircall</label>
          <label class="checkbox-option" onclick="toggleCheck(this)"><input type="checkbox" name="tools" value="Google Workspace"> Google Workspace</label>
          <label class="checkbox-option" onclick="toggleCheck(this)"><input type="checkbox" name="tools" value="AI Tools"> AI Tools</label>
          <label class="checkbox-option" onclick="toggleCheck(this)"><input type="checkbox" name="tools" value="None"> None</label>
        </div>
      </div>
      <div class="field">
        <label>Are you comfortable using AI tools daily? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="aiComfort" value="Yes ‚Äî I already use AI tools regularly" required><span>Yes ‚Äî I already use AI tools regularly</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="aiComfort" value="Yes ‚Äî I'm eager to learn"><span>Yes ‚Äî I'm eager to learn</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="aiComfort" value="No"><span>No</span></label>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-label">Schedule &amp; Work Setup</div>
      <div class="field">
        <label>Hours are Mon‚ÄìFri, 9 AM‚Äì6 PM EST. Not flexible. <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="scheduleCommit" value="Yes ‚Äî I can work 9 AM‚Äì6 PM EST consistently. I understand the hours are not flexible." required><span>Yes ‚Äî I can work 9 AM‚Äì6 PM EST consistently. I understand the hours are not flexible.</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="scheduleCommit" value="I prefer flexible hours"><span>I prefer flexible hours</span></label>
        </div>
      </div>
      <div class="field">
        <label>What is your internet speed? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="internetSpeed" value="50 Mbps or lower" required><span>50 Mbps or lower</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="internetSpeed" value="50‚Äì100 Mbps"><span>50‚Äì100 Mbps</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="internetSpeed" value="100+ Mbps"><span>100+ Mbps</span></label>
        </div>
      </div>
      <div class="field">
        <label>Private, quiet room at home? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="quietRoom" value="Yes" required><span>Yes</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="quietRoom" value="No"><span>No</span></label>
        </div>
      </div>
      <div class="field">
        <label>Reliable, uninterrupted power/electricity? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="electricity" value="Yes ‚Äî rarely or never have outages" required><span>Yes ‚Äî rarely or never experience outages</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="electricity" value="Sometimes ‚Äî occasional outages but have backup"><span>Sometimes ‚Äî but I have a backup (UPS/generator)</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="electricity" value="No ‚Äî outages are common"><span>No ‚Äî outages are common in my area</span></label>
        </div>
      </div>
      <div class="field">
        <label>Looking for a long-term position (5+ years)? <span class="req">*</span></label>
        <div class="radio-group">
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="longTerm" value="Yes" required><span>Yes</span></label>
          <label class="radio-option" onclick="selectRadio(this)"><input type="radio" name="longTerm" value="No"><span>No</span></label>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="section-label">Written Responses</div>
      <div class="field">
        <label>Tell me about a time you helped a frustrated or confused customer through a technical issue. How did you handle it? <span class="req">*</span></label>
        <div class="hint">100+ words required. Write as if being evaluated on English writing skills ‚Äî grammar, clarity, and professionalism matter.</div>
        <textarea name="customerStory" required placeholder="Describe the situation, your approach, and the result..."></textarea>
        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;text-align:right" id="wc1">0 words</div>
      </div>
      <div class="field">
        <label>Visit <a href="https://www.bodno.com" target="_blank" style="color:var(--blue)">www.bodno.com</a> and watch <a href="https://www.youtube.com/watch?v=qiivcYqNaSs" target="_blank" style="color:var(--blue)">this video</a>. What relevant experience would make you effective at onboarding customers on this product? <span class="req">*</span></label>
        <div class="hint">50+ words. Include hardware setup, software training, or technical walkthrough experience.</div>
        <textarea name="relevantExperience" required placeholder="Describe your relevant experience..."></textarea>
        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;text-align:right" id="wc2">0 words</div>
      </div>
    </div>

    <div class="card" style="text-align:center">
      <button type="submit" class="btn-primary" id="submitBtn">Submit Application</button>
      <p style="font-size:11.5px;color:var(--text-muted);margin-top:12px">By submitting, you confirm all information is accurate.</p>
    </div>
  </form>

  <div id="successScreen" style="display:none">
    <div class="card success-screen">
      <div class="success-icon">‚úì</div>
      <h2>Application Submitted!</h2>
      <p>Thank you for applying to Bodno.com. If you're a strong fit, we'll reach out via WhatsApp or email within 5 business days.</p>
    </div>
  </div>
</div>

<!-- ===== ADMIN ===== -->
<div id="adminView" style="display:none">
  <div id="adminPwScreen" class="container">
    <div class="card password-screen">
      <h2>üîí Admin Dashboard</h2>
      <p style="color:var(--text-muted);font-size:14px;margin-bottom:20px">Enter password to view applications.</p>
      <input type="password" id="adminPw" placeholder="Password" onkeydown="if(event.key==='Enter')checkPw()">
      <button class="btn-primary" onclick="checkPw()">Enter</button>
      <div class="pw-error" id="pwErr">Incorrect password.</div>
    </div>
  </div>
  <div id="adminDash" style="display:none" class="container-wide">
    <div class="error-banner" id="adminErr"></div>
    <div class="admin-stats" id="stats"></div>
    <div class="admin-bar">
      <div class="filter-group"><label style="font-size:12px;font-weight:600">Graveyard:</label>
        <select id="fG" onchange="renderTable()"><option value="">All</option><option value="2+ years">2+ yrs ‚úì</option><option value="1‚Äì2 years">1‚Äì2 yrs</option><option value="Less than 1 year">&lt;1 yr</option><option value="No graveyard shift experience">None</option></select>
      </div>
      <div class="filter-group"><label style="font-size:12px;font-weight:600">Schedule:</label>
        <select id="fS" onchange="renderTable()"><option value="">All</option><option value="Yes">Committed ‚úì</option><option value="flexible">Wants Flexible</option></select>
      </div>
      <div class="filter-group"><label style="font-size:12px;font-weight:600">Enthusiasm:</label>
        <select id="fE" onchange="renderTable()"><option value="">All</option><option value="Yes">Yes ‚úì</option><option value="Somewhat">Somewhat</option><option value="No">No</option></select>
      </div>
      <div class="filter-group"><label style="font-size:12px;font-weight:600">Internet:</label>
        <select id="fI" onchange="renderTable()"><option value="">All</option><option value="100+">100+ ‚úì</option><option value="50‚Äì100">50‚Äì100</option><option value="50 or lower">‚â§50</option></select>
      </div>
      <div class="filter-group"><label style="font-size:12px;font-weight:600">Long-term:</label>
        <select id="fL" onchange="renderTable()"><option value="">All</option><option value="Yes">Yes ‚úì</option><option value="No">No</option></select>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn-outline" onclick="resetFilters()">Reset</button>
        <button class="btn-secondary" onclick="loadApps()">üîÑ Refresh</button>
        <button class="btn-secondary" onclick="exportXL()" style="background:var(--accent)">üì• Excel</button>
      </div>
    </div>
    <div style="margin-bottom:16px"><span class="count" id="rCount"></span></div>
    <div class="table-wrap">
      <table><thead><tr><th>#</th><th>Date</th><th>Name</th><th>Email</th><th>Graveyard</th><th>CS Exp</th><th>Enthusiasm</th><th>Schedule</th><th>Internet</th><th>Tools</th><th></th></tr></thead>
      <tbody id="tBody"><tr><td colspan="11" style="text-align:center;padding:40px;color:var(--text-muted)">Loading...</td></tr></tbody></table>
    </div>
  </div>
</div>

<!-- MODAL -->
<div class="modal-overlay" id="modal"><div class="modal"><button class="modal-close" onclick="closeModal()">&times;</button><h3 id="mTitle"></h3><div id="mContent"></div></div></div>

<script>
let apps=[];
function selectRadio(el){el.closest('.radio-group').querySelectorAll('.radio-option').forEach(o=>o.classList.remove('selected'));el.classList.add('selected');el.querySelector('input[type="radio"]').checked=true}
function toggleCheck(el){setTimeout(()=>{const c=el.querySelector('input[type="checkbox"]');el.classList.toggle('selected',c.checked)},10)}
document.querySelector('[name="customerStory"]')?.addEventListener('input',function(){const w=this.value.trim().split(/\s+/).filter(x=>x).length;const e=document.getElementById('wc1');e.textContent=w+' words';e.style.color=w>=100?'var(--success)':'var(--text-muted)'});
document.querySelector('[name="relevantExperience"]')?.addEventListener('input',function(){const w=this.value.trim().split(/\s+/).filter(x=>x).length;const e=document.getElementById('wc2');e.textContent=w+' words';e.style.color=w>=50?'var(--success)':'var(--text-muted)'});

async function submitForm(e){
  e.preventDefault();const form=e.target;const btn=document.getElementById('submitBtn');const err=document.getElementById('formError');err.style.display='none';
  const s1=form.customerStory.value.trim().split(/\s+/).filter(x=>x).length;
  const s2=form.relevantExperience.value.trim().split(/\s+/).filter(x=>x).length;
  if(s1<100){err.textContent='Customer story must be at least 100 words (currently '+s1+').';err.style.display='block';err.scrollIntoView({behavior:'smooth',block:'center'});return}
  if(s2<50){err.textContent='Relevant experience must be at least 50 words (currently '+s2+').';err.style.display='block';err.scrollIntoView({behavior:'smooth',block:'center'});return}
  const fd=new FormData(form);const tools=[];form.querySelectorAll('[name="tools"]:checked').forEach(c=>tools.push(c.value));
  const payload={fullName:fd.get('fullName'),email:fd.get('email'),whatsapp:fd.get('whatsapp'),ojphProfile:fd.get('ojphProfile'),resumeLink:fd.get('resumeLink'),videoLink:fd.get('videoLink'),enthusiasm:fd.get('enthusiasm'),csExperience:fd.get('csExperience'),graveyardExperience:fd.get('graveyardExperience'),tools:tools.join(', '),aiComfort:fd.get('aiComfort'),scheduleCommit:fd.get('scheduleCommit'),internetSpeed:fd.get('internetSpeed'),quietRoom:fd.get('quietRoom'),electricity:fd.get('electricity'),longTerm:fd.get('longTerm'),customerStory:fd.get('customerStory'),relevantExperience:fd.get('relevantExperience')};
  btn.disabled=true;btn.innerHTML='<span class="spinner"></span> Submitting...';
  try{
    await fetch(SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'text/plain'},body:JSON.stringify(payload)});
    document.getElementById('applicationForm').style.display='none';
    document.getElementById('introCard').style.display='none';
    document.getElementById('warningCard').style.display='none';
    document.getElementById('successScreen').style.display='block';
    window.scrollTo({top:0,behavior:'smooth'});
  }catch(er){err.textContent='Error submitting. Check your internet and try again.';err.style.display='block';btn.disabled=false;btn.textContent='Submit Application'}
}

function showAdminLogin(){document.getElementById('formView').style.display='none';document.getElementById('adminView').style.display='block';document.getElementById('adminPwScreen').style.display='block';document.getElementById('adminDash').style.display='none';document.getElementById('adminToggle').textContent='üìù Form';document.getElementById('adminToggle').onclick=showForm;document.getElementById('headerTitle').textContent='Admin Dashboard';document.getElementById('headerSub').textContent='Review, filter, and export applications'}
function showForm(){document.getElementById('formView').style.display='block';document.getElementById('adminView').style.display='none';document.getElementById('adminToggle').textContent='üîí Admin';document.getElementById('adminToggle').onclick=showAdminLogin;document.getElementById('headerTitle').textContent='Customer Onboarding Specialist Application';document.getElementById('headerSub').textContent='Remote ‚Äî Full-time ‚Äî $600/mo base + up to $400/mo commission'}
function checkPw(){if(document.getElementById('adminPw').value==='bodno2026'){document.getElementById('adminPwScreen').style.display='none';document.getElementById('adminDash').style.display='block';loadApps()}else{document.getElementById('pwErr').style.display='block'}}

async function loadApps(){
  const err=document.getElementById('adminErr');err.style.display='none';
  document.getElementById('tBody').innerHTML='<tr><td colspan="11" style="text-align:center;padding:40px;color:var(--text-muted)"><div class="spinner" style="border-color:var(--border);border-top-color:var(--blue)"></div> Loading...</td></tr>';
  try{
    const res=await fetch(SCRIPT_URL+'?password=bodno2026&t='+Date.now());const json=await res.json();
    if(json.status==='unauthorized'){err.textContent='Unauthorized.';err.style.display='block';return}
    apps=(json.data||[]).map((r,i)=>({id:i,submittedAt:r['Timestamp']||'',fullName:r['Full Name']||'',email:r['Email']||'',whatsapp:r['WhatsApp']||'',ojphProfile:r['OJP Profile']||'',resumeLink:r['Resume Link']||'',videoLink:r['Video Link']||'',enthusiasm:r['Enthusiasm']||'',csExperience:r['CS Experience']||'',graveyardExperience:r['Graveyard Experience']||'',tools:r['Tools']||'',aiComfort:r['AI Comfort']||'',scheduleCommit:r['Schedule Commitment']||'',internetSpeed:r['Internet Speed']||'',quietRoom:r['Quiet Room']||'',electricity:r['Electricity']||'',longTerm:r['Long Term']||'',customerStory:r['Customer Story']||'',relevantExperience:r['Relevant Experience']||''}));
    renderStats();renderTable();
  }catch(er){err.innerHTML='Could not load. Verify:<br>1. Google Apps Script is deployed<br>2. SCRIPT_URL is correct<br>3. Access is set to "Anyone"<br><br>'+er.message;err.style.display='block';document.getElementById('tBody').innerHTML='<tr><td colspan="11" style="text-align:center;padding:40px;color:var(--error)">Failed to load.</td></tr>'}
}

function renderStats(){
  const t=apps.length,q=apps.filter(a=>a.graveyardExperience==='2+ years').length,c=apps.filter(a=>(a.scheduleCommit||'').startsWith('Yes')).length,e=apps.filter(a=>(a.enthusiasm||'').startsWith('Yes')).length;
  document.getElementById('stats').innerHTML=`<div class="stat-card"><div class="stat-num">${t}</div><div class="stat-label">Total</div></div><div class="stat-card"><div class="stat-num">${q}</div><div class="stat-label">2+ Yr Graveyard</div></div><div class="stat-card"><div class="stat-num">${c}</div><div class="stat-label">Schedule OK</div></div><div class="stat-card"><div class="stat-num">${e}</div><div class="stat-label">Enthusiastic</div></div>`;
}

function getFiltered(){
  let d=[...apps];
  const g=document.getElementById('fG').value,s=document.getElementById('fS').value,e=document.getElementById('fE').value,i=document.getElementById('fI').value,l=document.getElementById('fL').value;
  if(g)d=d.filter(a=>a.graveyardExperience===g);
  if(s==='Yes')d=d.filter(a=>(a.scheduleCommit||'').startsWith('Yes'));
  if(s==='flexible')d=d.filter(a=>(a.scheduleCommit||'').includes('flexible'));
  if(e==='Yes')d=d.filter(a=>(a.enthusiasm||'').startsWith('Yes'));
  if(e==='Somewhat')d=d.filter(a=>(a.enthusiasm||'').startsWith('Somewhat'));
  if(e==='No')d=d.filter(a=>a.enthusiasm==='No');
  if(i==='100+')d=d.filter(a=>(a.internetSpeed||'').includes('100'));
  if(i==='50‚Äì100')d=d.filter(a=>(a.internetSpeed||'').includes('50‚Äì100'));
  if(i==='50 or lower')d=d.filter(a=>(a.internetSpeed||'').includes('lower'));
  if(l)d=d.filter(a=>a.longTerm===l);
  return d;
}

function renderTable(){
  const data=getFiltered();document.getElementById('rCount').textContent=`Showing ${data.length} of ${apps.length} applications`;
  const tb=document.getElementById('tBody');
  if(!data.length){tb.innerHTML='<tr><td colspan="11" style="text-align:center;padding:40px;color:var(--text-muted)">No matches.</td></tr>';return}
  tb.innerHTML=data.map((a,i)=>{
    let dt='';try{dt=new Date(a.submittedAt).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'})}catch(e){dt=a.submittedAt}
    const gB=a.graveyardExperience==='2+ years'?'badge-green':((a.graveyardExperience||'').includes('1‚Äì2')?'badge-yellow':'badge-red');
    const sB=(a.scheduleCommit||'').startsWith('Yes')?'badge-green':'badge-red';
    const eB=(a.enthusiasm||'').startsWith('Yes')?'badge-green':((a.enthusiasm||'').startsWith('Somewhat')?'badge-yellow':'badge-red');
    return`<tr><td>${i+1}</td><td style="white-space:nowrap">${dt}</td><td><strong>${esc(a.fullName)}</strong></td><td class="truncate">${esc(a.email)}</td><td><span class="badge ${gB}">${esc(a.graveyardExperience)}</span></td><td>${esc(a.csExperience)}</td><td><span class="badge ${eB}">${(a.enthusiasm||'').split(' ‚Äî')[0]}</span></td><td><span class="badge ${sB}">${(a.scheduleCommit||'').startsWith('Yes')?'Committed':'Flexible'}</span></td><td>${esc(a.internetSpeed)}</td><td class="truncate">${esc(a.tools)}</td><td><button class="expand-btn" onclick="showDetail(${a.id})">View</button></td></tr>`;
  }).join('');
}

function esc(s){if(!s)return'';const d=document.createElement('div');d.textContent=s;return d.innerHTML}

function showDetail(id){
  const a=apps.find(x=>x.id===id);if(!a)return;
  document.getElementById('mTitle').textContent=a.fullName;
  const f=[['Email',a.email],['WhatsApp',a.whatsapp],['Submitted',a.submittedAt?new Date(a.submittedAt).toLocaleString():''],
    ['OJP Profile',a.ojphProfile?`<a href="${esc(a.ojphProfile)}" target="_blank" style="color:var(--blue);word-break:break-all">${esc(a.ojphProfile)}</a>`:''],
    ['Resume',a.resumeLink?`<a href="${esc(a.resumeLink)}" target="_blank" style="color:var(--blue);word-break:break-all">${esc(a.resumeLink)}</a>`:''],
    ['Video',a.videoLink?`<a href="${esc(a.videoLink)}" target="_blank" style="color:var(--blue);word-break:break-all">${esc(a.videoLink)}</a>`:''],
    ['Enthusiasm',a.enthusiasm],['CS Experience',a.csExperience],['Graveyard Experience',a.graveyardExperience],
    ['Tools',a.tools],['AI Comfort',a.aiComfort],['Schedule',a.scheduleCommit],['Internet',a.internetSpeed],
    ['Quiet Room',a.quietRoom],['Electricity',a.electricity],['Long-term',a.longTerm],
    ['Customer Story',`<div style="white-space:pre-wrap;background:var(--bg);padding:12px;border-radius:6px;font-size:13px;margin-top:4px">${esc(a.customerStory)}</div>`],
    ['Relevant Experience',`<div style="white-space:pre-wrap;background:var(--bg);padding:12px;border-radius:6px;font-size:13px;margin-top:4px">${esc(a.relevantExperience)}</div>`]];
  document.getElementById('mContent').innerHTML=f.map(([l,v])=>`<div class="detail-row"><div class="detail-label">${l}</div><div class="detail-value">${v||'‚Äî'}</div></div>`).join('');
  document.getElementById('modal').classList.add('active');
}
function closeModal(){document.getElementById('modal').classList.remove('active')}
document.getElementById('modal').addEventListener('click',function(e){if(e.target===this)closeModal()});
function resetFilters(){['fG','fS','fE','fI','fL'].forEach(id=>document.getElementById(id).value='');renderTable()}

function exportXL(){
  const data=getFiltered();if(!data.length){alert('No data.');return}
  const rows=data.map((a,i)=>({'#':i+1,'Submitted':a.submittedAt?new Date(a.submittedAt).toLocaleString():'','Name':a.fullName,'Email':a.email,'WhatsApp':a.whatsapp,'OJP Profile':a.ojphProfile,'Resume':a.resumeLink,'Video':a.videoLink,'Enthusiasm':a.enthusiasm,'CS Experience':a.csExperience,'Graveyard Experience':a.graveyardExperience,'Tools':a.tools,'AI Comfort':a.aiComfort,'Schedule':a.scheduleCommit,'Internet':a.internetSpeed,'Quiet Room':a.quietRoom,'Electricity':a.electricity,'Long-term':a.longTerm,'Customer Story':a.customerStory,'Relevant Experience':a.relevantExperience}));
  const ws=XLSX.utils.json_to_sheet(rows);
  ws['!cols']=[{wch:4},{wch:18},{wch:22},{wch:28},{wch:18},{wch:32},{wch:32},{wch:32},{wch:20},{wch:14},{wch:16},{wch:25},{wch:22},{wch:16},{wch:14},{wch:10},{wch:18},{wch:10},{wch:50},{wch:50}];
  const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Applications');
  XLSX.writeFile(wb,`Bodno_Applications_${new Date().toISOString().slice(0,10)}.xlsx`);
}
</script>
</body>
</html>
